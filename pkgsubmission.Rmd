
# Guide for Editors  {#pkgsubmission}

## Automated Checks

Upon initial submission, the `ropensci-review-bot` performs a suite of tests
and checks, and will paste a report into the GitHub issue thread. This report
is the primary source of information used to inform initial editorial
decisions. The best way to understand how decisions are to be made in response
to these reports is to provide a concrete example. The remainder of this
initial sub-section contains the contents of such a report, generated for
an R package generated by the [`srr::srr_stats_pkg_skeleton()`
function](https://ropenscilabs.github.io/srr/reference/srr_stats_pkg_skeleton.html),
with additional statistical standards inserted with the
[`srr::srr_stats_roxygen()`
function](https://ropenscilabs.github.io/srr/reference/srr_stats_roxygen.html).

A similar report can be reproduced locally with these lines:

```{r pkgcheck-code, eval = FALSE, echo = TRUE}
library (srr)
library (pkgcheck)
path <- srr_stats_pkg_skeleton ()
srr_stats_roxygen (category = "regression",
                   filename = file.path (path, "R", "srr-standards.R"))
check <- pkgcheck (path)
md <- checks_to_markdown (check, render = TRUE)
```

---



```{r pkgcheck-ex, child = "scripts/pkgcheck-ex.md", eval = TRUE, echo = TRUE}
```

---


## Editor-in-Chief

As for rOpenSci's current peer-review system, packages are submitted directly
to the [`ropensci/software-review`
repository](https://github.com/ropensci/software-review) on GitHub, with
submissions handled initially by the rotating Editor-in-Chief (EiC).
Statistical software is nevertheless handled differently to standard (non-statistical) packages from the first moment
of submission. Statistical submissions use a different template, the submission
of which automatically generates a detailed report from our
`ropensci-review-bot` that indicates whether a submission may proceed, based on
whether it passes all of the automated checks listed in the following
sub-section.


### Editor-in-Chief Responses

A positive bot response is sufficient for the EiC to proceed directly to
delegate a handling editor without further consideration. Additional effort by
the EiC will only be required in "edge cases" where a package may be unable to
pass one of the checks. In these cases, submitting authors must explain why
these checks may fail, and the EiC must then determine whether these failures
are acceptable.

There only additional responsibilities for the EiC prior to delegating handling
editors are to check the following single item:

- [ ] The categories nominated by the submitting authors are appropriate for
  this package

And to choose one the following two items:

- [ ] The package does not fit within any additional categories of statistical
  software.
- [ ] The package could potentially be described by the following additional
  categories of statistical software:
    - \<list categories here\>


### Bot checks executed on initial submission {#pkgsub-botchecks}

The checks prompted by an initial submission, and required for the EiC to
immediately proceed to delegate a handling editor, are generated by the
[`pkgcheck` package](https://github.com/ropenscilabs/pkgcheck), and include:

1. Package must use [`roxygen2`](https://roxygen2.r-lib.org) for documentation.
2. Package must have a [`contributing.md`
   file](https://devguide.ropensci.org/collaboration.html#contributing-guide).
3. Package must have a [`CITATION` file in the `inst`
   directory](https://cran.r-project.org/doc/manuals/r-release/R-exts.html#CITATION-files).
4. Package must have a [`codemeta.json`
   file](https://devguide.ropensci.org/building.html#creating-metadata-for-your-package).
5. All exported functions must include examples in their documentation.
6. Left-assign operators must be used consistently throughout all code (so
   either all `=` or all `<-`, but not a mixture of both).
7. Package `DESCRIPTION` file must have a "URL" field.
8. Package `DESCRIPTION` file must have a "BugReports" field.
9. Package name must be available (or package must already be) on CRAN.
10. Package must have continuous integration tests.
11. Package must have test coverage of at least 75%.
12. No function should have a [cyclomatic
    complexity](https://github.com/MangoTheCat/cyclocomp) of 15 or greater.
13. `R CMD check` must generate no warnings or errors.
14. All statistical standards must be documented, as confirmed by the
    [`srr::srr_pre_submit()`
    function](https://ropenscilabs.github.io/srr/reference/srr_stats_pre_submit.html).


Packages which pass all checks will receive a simple response from the
`ropensci-review-bot` that, "*This package passes all checks and may be
submitted*." For packages which fail any of these tests, the bot response will
state that authors must either address failing checks, or justify why package
review might proceed regardless. Only in the latter case will the EiC have to
make a subjective judgement whether the package may proceed further or not.

Such cases ought nevertheless be rare, and it may be expected in the majority
of cases that the sole task of the EiC is to confirm a positive bot response,
and to allocate a handling editor. This is done by calling
`@ropensci-review-bot assign <name> as editor`.



## Handling Editor

The Handling Editor can use the summary report generated by the opening of the
issue to guide the steps towards assigning reviewers.

### Automatic Summary Reports {#pkgsub-summary-reports}

The summary report generated when the EiC nominates a Handling Editor includes
the following components:

1. The statistical categories designated by the authors, as identified from the
   [`srr` documentation](https://github.com/ropenscilabs/srr) documentation
   within the package.
2. An overview of [`goodpractice`
   checks](https://github.com/MangoTheCat/goodpractice) checks including:
    - Code coverage estimates for each file (from the [`covr`
      package](https://github.com/r-lib/covr)).
    - Code style reports from the [`lintr`
      package](https://github.com/jimhester/lintr).
    - Cyclomatic complexity reports from the [`cyclocomp`
      package](https://github.com/MangoTheCat/cyclocomp).
    - Any errors, warnings, or notes raised by running `R CMD check` (from the
      [`rcmdcheck` package](https://github.com/r-lib/rcmdcheck).
3. A summary of lines of code and computer languages used (from the [`cloc`
   package](https://github.com/hrbrmstr/cloc)).
4. An indication of any ways by which the package is statistically anomalous in
   relation to all current CRAN packages. The measures considered include:
    - Size of code base
    - Number of vignettes
    - Number of package URLs given in `DESCRIPTION` file
    - Number of people listed in `DESCRIPTION` file for each ascribed role
      (such as `aut` and `ctb`)
    - Number of exported functions
    - Number of non-exported functions
    - Number of documentation lines per function
    - Number of parameters per function
    - Metrics of white space in code (in terms both of lines and indentation)

Significant issues raised in the
[`goodpractice`](https://github.com/MangoTheCat/goodpractice) reports should be
addressed prior to proceeding with review. The
[`cloc`](https://github.com/hrbrmstr/cloc)) output can be used to ensure
reviewers have appropriate experience and abilities with the language(s) in
which a package is written, while any anomalies in any of the properties
indicated in the third of these components may need to be addressed prior to
proceeding with review.

### Handling Editor Checklist

The following items comprise the checklist for Handling Editors which should be
pasted into the issue, and all items checked prior to proceeding with review.

- [ ] Any issues raised during initial processing by EiC have been resolved (or
  there were none).
- [ ] The statistical categories seem appropriate, and no additional categories
  would be applicable to the package.
- [ ] **Either** (i) there were no issues raised in the `goodpractice` checks
  which need to be addressed prior to review, or (ii) all issues have been
  appropriately addressed.
- [ ] Running
  [`autotest_package()`](https://ropenscilabs.github.io/autotest/reference/autotest_package.html)
  on a local version of the source code generates no errors.
- [ ] **Either** (i) this package is aiming for a bronze badge, **or**, (ii)
  for packages aiming for silver or gold badges, the authors have clarified
  which of the four aspects listed in the "*Guide for Authors*" section on
  [silver badges](#pkgdev-silver) they intend to fulfil.
- [ ] **Either** (i) the package manifests no statistical anomalies in relation
  to the CRAN archive, **or** (ii) any statistical anomalies have been
  satisfactorily explained.

All of these items must be checked prior to assigning reviewers. This may
require iteration with submitting authors. As stated in the 
[*Dev Guide*](https://devguide.ropensci.org/editorguide.html#upon-submission):

- If authors believe changes might take time, [apply the holding
  label](#policiesreviewprocess) to the submission.
- If the package raises a new issue for rOpenSci policy, start a conversation
  in Slack or open a discussion on the [rOpenSci
  forum](https://discuss.ropensci.org/) to discuss it with other editors
  ([example of policy
  discussion](https://discuss.ropensci.org/t/overlap-policy-for-package-onboarding/368)).

Once all items have been checked, Handling Editors may assign reviewers using
the command `@ropensci-review-bot assign stats reviewer <name>`, and generally
following the procedure given in the [*Dev
Guide*](https://devguide.ropensci.org/editorguide.html#look-for-and-assign-reviewers).
Assigning a reviewer will prompt the bot to deliver an additional report of
package structure and function for use by reviewers, as described in the
following chapter.
